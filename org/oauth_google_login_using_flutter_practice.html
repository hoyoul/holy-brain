<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2023-11-26 Sun 03:37 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>[oauth] google login using flutter-practice</title>
<meta name="author" content="hoyoul" />
<meta name="description" content="oauth2.0 flutter로 구현" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
</head>
<body>
<div id="content" class="content">
<h1 class="title">[oauth] google login using flutter-practice</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgd944874">1. flutter project만들기</a></li>
<li><a href="#org42d07bd">2. GCP 처리</a>
<ul>
<li><a href="#org245066a">2.1. GCP(Google Cloud Platform)에 app등록</a>
<ul>
<li><a href="#orgd0e1ca7">2.1.1. gcp 접속</a></li>
<li><a href="#org32af68d">2.1.2. project 생성</a></li>
<li><a href="#orgfa8da67">2.1.3. project명 설정</a></li>
<li><a href="#orgc8cc7cc">2.1.4. project가 사용할 서비스 설정</a></li>
<li><a href="#org66d7f9f">2.1.5. oauth consent screen 설정</a></li>
<li><a href="#orgb1dad03">2.1.6. scopes 설정</a></li>
<li><a href="#org7481387">2.1.7. test users 설정</a></li>
<li><a href="#orgc1e41b9">2.1.8. summary</a></li>
<li><a href="#orgd25bb39">2.1.9. credentials</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgae3be0f">3. google<sub>sign</sub><sub>in</sub> package</a>
<ul>
<li><a href="#org22791b2">3.1. 개요</a></li>
<li><a href="#org88b9bf9">3.2. Demo실행</a>
<ul>
<li><a href="#org2ceec26">3.2.1. google<sub>sign</sub><sub>in</sub> package</a></li>
<li><a href="#org6051526">3.2.2. http package</a></li>
<li><a href="#org136e619">3.2.3. import 'src/sign<sub>in</sub><sub>button.dart</sub>'; 에러</a></li>
<li><a href="#orge178279">3.2.4. 실행</a></li>
<li><a href="#org715a8d6">3.2.5. ios integration</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-orgd944874" class="outline-2">
<h2 id="orgd944874"><span class="section-number-2">1.</span> flutter project만들기</h2>
<div class="outline-text-2" id="text-1">
<p>
shell에서 flutter package(project)를 만든다. flutter create란 명령어를
사용한다. package명은 모두 소문자여야 한다. 보통 snake<sub>case라고</sub> 한다.
</p>
<div class="org-src-container">
<pre class="src src-shell">flutter create login_page
</pre>
</div>
</div>
</div>
<div id="outline-container-org42d07bd" class="outline-2">
<h2 id="org42d07bd"><span class="section-number-2">2.</span> GCP 처리</h2>
<div class="outline-text-2" id="text-2">
<p>
oauth login을 위해서 GCP에 접속해서 할께 있다.
</p>
</div>
<div id="outline-container-org245066a" class="outline-3">
<h3 id="org245066a"><span class="section-number-3">2.1.</span> GCP(Google Cloud Platform)에 app등록</h3>
<div class="outline-text-3" id="text-2-1">
<p>
google login 접속을 위해선, GCP에 app등록을 해야한다. 사용자가 goolge
login시 인증과 id가 없을때 google 회원가입도 google gcp에서 관장한다.
</p>
</div>

<div id="outline-container-orgd0e1ca7" class="outline-4">
<h4 id="orgd0e1ca7"><span class="section-number-4">2.1.1.</span> gcp 접속</h4>
<div class="outline-text-4" id="text-2-1-1">
<p>
<a href="https://console.cloud.google.com/">여기</a>로 접속한다. login이 안되어 있다면 login한다.
</p>

<div id="orgd0ddeef" class="figure">
<p><img src="../static/img/flutter/gcp1.png" alt="gcp1.png" width="400px" />
</p>
<p><span class="figure-number">Figure 1: </span>gcp 접속</p>
</div>
</div>
</div>
<div id="outline-container-org32af68d" class="outline-4">
<h4 id="org32af68d"><span class="section-number-4">2.1.2.</span> project 생성</h4>
<div class="outline-text-4" id="text-2-1-2">
<p>
새로운 project를 만들기 위해서 new project를 click한다.
</p>

<div id="org1f5df4f" class="figure">
<p><img src="../static/img/flutter/gcp2.png" alt="gcp2.png" width="400px" />
</p>
<p><span class="figure-number">Figure 2: </span>project 생성1</p>
</div>
</div>
</div>
<div id="outline-container-orgfa8da67" class="outline-4">
<h4 id="orgfa8da67"><span class="section-number-4">2.1.3.</span> project명 설정</h4>
<div class="outline-text-4" id="text-2-1-3">
<p>
project의 이름을 Google Login이라고 하고, No Organization으로 한다. 
</p>

<div id="orgf0cd5b4" class="figure">
<p><img src="../static/img/flutter/gcp3.png" alt="gcp3.png" width="400px" />
</p>
<p><span class="figure-number">Figure 3: </span>project 생성3</p>
</div>
</div>
</div>
<div id="outline-container-orgc8cc7cc" class="outline-4">
<h4 id="orgc8cc7cc"><span class="section-number-4">2.1.4.</span> project가 사용할 서비스 설정</h4>
<div class="outline-text-4" id="text-2-1-4">
<p>
API &amp; Service를 선택한다.
</p>

<div id="orgb6f8fee" class="figure">
<p><img src="../static/img/flutter/gcp4.png" alt="gcp4.png" width="400px" />
</p>
<p><span class="figure-number">Figure 4: </span>project 생성4</p>
</div>
</div>
</div>
<div id="outline-container-org66d7f9f" class="outline-4">
<h4 id="org66d7f9f"><span class="section-number-4">2.1.5.</span> oauth consent screen 설정</h4>
<div class="outline-text-4" id="text-2-1-5">
<p>
사용자에게 동의서 받는 화면을 작성한다. 사용자를 대신해서 app이 GCP
resource에 접근할 것이기 때문이다. 동의서 화면은 GCP에서 알아서
만들어준다. 내가 할것은 내 app이 어떤 app이고,이름이 무엇이고,
사용자를 대신해서 어떤 GCP resource를 사용할 지를 GCP에게 전달해주면
된다. GCP에서 사용자 동의서 화면을 만들어준다. 사용자가 oauth를
사용할때 oauth consent화면이 나온다. 이 화면을 어떻게 만들지 설정하는
과정이다. 어떤 사용자가 oauth를 사용할 지를 정하는 과정이다. 추가
설명하자면, 내가 만든 앱에서 GCP resource인 api를 사용할 수도 있고,
app을 사용하는 사용자가 app을 통해서 GCP의 api를 사용할 수 있다. 어떤
사용자가 api를 사용하는지를 설정한다.
</p>

<p>
내 경우, 내가 만든 app을 사용하는 일반사용자가 app을 통해서 GCP 인증
서비스를 사용할 거라서 external을 설정했다.
</p>


<div id="org40fef54" class="figure">
<p><img src="../static/img/flutter/gcp5.png" alt="gcp5.png" width="400px" />
</p>
<p><span class="figure-number">Figure 5: </span>project 생성5</p>
</div>
</div>
<ol class="org-ol">
<li><a id="org7847852"></a>oauth consent screen2 - app information<br />
<div class="outline-text-5" id="text-2-1-5-1">
<p>
app information를 등록한다. app을 통해서 resource를 사용할 것이기
때문이다.
</p>

<div id="org5b92a9a" class="figure">
<p><img src="../static/img/flutter/gcp6-0.png" alt="gcp6-0.png" width="400px" />
</p>
<p><span class="figure-number">Figure 6: </span>project 생성6</p>
</div>
</div>
</li>
<li><a id="orgc356cdb"></a>oauth consent screen3-app logo<br />
<div class="outline-text-5" id="text-2-1-5-2">
<p>
consent화면에 보여질 logo를 설정한다.
</p>

<div id="org14cd61a" class="figure">
<p><img src="../static/img/flutter/gcp6-1.png" alt="gcp6-1.png" width="400px" />
</p>
<p><span class="figure-number">Figure 7: </span>consent logo</p>
</div>
</div>
</li>
<li><a id="orgb3f3ead"></a>oauth consent screen3-app domain<br />
<div class="outline-text-5" id="text-2-1-5-3">
<p>
consent화면에 app을 사용하는 사용자에게 안전하다는것을 보여주기 위해서
app의 homepage, 그리고 policy와 service term을 link로 연결할수
있다. 그것을 setting한다.
</p>

<div id="orgd1c4cb1" class="figure">
<p><img src="../static/img/flutter/gcp6-2.png" alt="gcp6-2.png" width="400px" />
</p>
<p><span class="figure-number">Figure 8: </span>consent term</p>
</div>

<p>
마지막에 Authorized domain을 설정할때는, google search시 해당
homepage를 찾을 수 있어야 Authorized로 본다. 그렇게 하기 위해선,
domain setting 처리를 해야한다. verify를 할려면 Google Search
Console을 click해서 처리한다. 우선 나는 처리하지 않았다.
</p>

<p>
consent화면에선 지금 처리한 것은 다음과 같다.
</p>


<div id="org8341421" class="figure">
<p><img src="../static/img/flutter/gcp6-3.png" alt="gcp6-3.png" width="400px" />
</p>
<p><span class="figure-number">Figure 9: </span>consent term2</p>
</div>
</div>
</li>


<li><a id="org033ffac"></a>oauth consent screen4- Developer contact information<br />
<div class="outline-text-5" id="text-2-1-5-4">
<p>
개발자 주소를 설정한다.
</p>

<div id="org0a3b598" class="figure">
<p><img src="../static/img/flutter/gcp6-4.png" alt="gcp6-4.png" width="400px" />
</p>
<p><span class="figure-number">Figure 10: </span>consent term2</p>
</div>
</div>
</li>
</ol>
</div>

<div id="outline-container-orgb1dad03" class="outline-4">
<h4 id="orgb1dad03"><span class="section-number-4">2.1.6.</span> scopes 설정</h4>
<div class="outline-text-4" id="text-2-1-6">
<p>
oauth의 말뜻처럼, 권한은 GCP의 resource api를 사용할수 있는 권한인데,
그 권한의 범위(scope)를 설정한다. GCP의 resource 중 우리에게 필요한건
사용자의 간단한 정보뿐이다. 즉, app이 받아와서 사용할 사용자의
정보인데, email, profile,openid resource들을 check한다. 이 정보를
GCP가 가진 resource라고 봐도 된다. 여기서, openID는 oauth에서 인증을
처리하는데 사용하는 id라서 반드시 체크한다. 우리가 oauth를 사용하는
이유는 회원가입 처리하지 않고 login하기 위해서이기 때문이다. 아래처럼
설정하자.
</p>

<div id="org51257df" class="figure">
<p><img src="../static/img/flutter/scope1.png" alt="scope1.png" width="400px" />
</p>
<p><span class="figure-number">Figure 11: </span>scope</p>
</div>

<p>
설정하면 다음과 같이 화면이 바뀐다. 우리가 요청한 resource들은
개인정보에 민감하거나 제한적이지 않기 때문에 non-sensitve scopes에서
볼수 있다. 다른 resource를 선택하면 Your sensitive scopes나, Your
restrict scopes에서 보여진다.
</p>

<div id="org0c8a118" class="figure">
<p><img src="../static/img/flutter/scope2.png" alt="scope2.png" width="400px" />
</p>
<p><span class="figure-number">Figure 12: </span>scope</p>
</div>
</div>
</div>


<div id="outline-container-org7481387" class="outline-4">
<h4 id="org7481387"><span class="section-number-4">2.1.7.</span> test users 설정</h4>
<div class="outline-text-4" id="text-2-1-7">
<p>
app을 publishing해서 사용자들한테 배포하기전 test단계에선 test user만
이 로긴기능을 사용하게 할 수 있다. 나는 일반인 사용자를 대상으로
test할것이기 때문에, 그냥 건너 뛴다.
</p>

<div id="orgb653b20" class="figure">
<p><img src="../static/img/flutter/test1.png" alt="test1.png" width="400px" />
</p>
<p><span class="figure-number">Figure 13: </span>test</p>
</div>
</div>
</div>

<div id="outline-container-orgc1e41b9" class="outline-4">
<h4 id="orgc1e41b9"><span class="section-number-4">2.1.8.</span> summary</h4>
<div class="outline-text-4" id="text-2-1-8">
<p>
여기까지 하면 oauth consent에 대한 처리가 끝났다. 요약화면을 보여준다.
</p>


<div id="orgf7360ab" class="figure">
<p><img src="../static/img/flutter/summary.png" alt="summary.png" width="400px" />
</p>
<p><span class="figure-number">Figure 14: </span>summary</p>
</div>
</div>
</div>

<div id="outline-container-orgd25bb39" class="outline-4">
<h4 id="orgd25bb39"><span class="section-number-4">2.1.9.</span> credentials</h4>
<div class="outline-text-4" id="text-2-1-9">
<p>
app이 GCP resource에 접근해야 하기 때문에 credentials가
필요하다. credentials은 ios,android 두개를 생성해야 한다. 
</p>
</div>

<ol class="org-ol">
<li><a id="orgae01f41"></a>ios credentials<br />
<div class="outline-text-5" id="text-2-1-9-1">

<div id="orge3b2e0e" class="figure">
<p><img src="../static/img/flutter/credentials1.png" alt="credentials1.png" width="400px" />
</p>
<p><span class="figure-number">Figure 15: </span>credentials1</p>
</div>


<div id="orgfe8ff2b" class="figure">
<p><img src="../static/img/flutter/credentials2.png" alt="credentials2.png" width="400px" />
</p>
<p><span class="figure-number">Figure 16: </span>credentials2</p>
</div>


<div id="org79ed8d9" class="figure">
<p><img src="../static/img/flutter/credentials3.png" alt="credentials3.png" width="400px" />
</p>
<p><span class="figure-number">Figure 17: </span>credentials3</p>
</div>

<p>
여기서 application type, app name은 어렵지 않다. 그런데 bundleID를
어디서 찾아야 할지 모를수 있다. 내 경우 xcode를 실행해서 찾았다.
xcode를 실행해서 flutter project의 ios/Runner을 open하면 다음과 같은
화면이 나온다. 여기에서 찾을수 있다.
</p>


<div id="org4a0dc0b" class="figure">
<p><img src="../static/img/flutter/credentials4.png" alt="credentials4.png" width="400px" />
</p>
<p><span class="figure-number">Figure 18: </span>credentials4</p>
</div>


<div id="org2ed6954" class="figure">
<p><img src="../static/img/flutter/credentials5.png" alt="credentials5.png" width="400px" />
</p>
<p><span class="figure-number">Figure 19: </span>credentials5</p>
</div>

<p>
이제 여기까지 하고 제출하면 된다. app store id와 team id는
option이고, 출시된 앱이 아니기 때문에 pass한다.
</p>

<p>
여기까지 하면 client id를 얻게 된다. 이것을 plist로 다운받을 수도
있다. app이 gcp에 접근할수 있게 되는 credentials을 만든것이다.
</p>
</div>
</li>
</ol>
</div>
</div>
</div>


<div id="outline-container-orgae3be0f" class="outline-2">
<h2 id="orgae3be0f"><span class="section-number-2">3.</span> google<sub>sign</sub><sub>in</sub> package</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org22791b2" class="outline-3">
<h3 id="org22791b2"><span class="section-number-3">3.1.</span> 개요</h3>
<div class="outline-text-3" id="text-3-1">
<p>
login page는 flutter에서 개발자가 만든다. Google login을 위해서
button도 만든다. google login버튼을 누르면 google에 접속해서
인증과정을 거친다. 이런 것을 모두 개발자가 만들지
않는다. google<sub>sign</sub><sub>in</sub> package를 사용하면, google에 접속해서
인증과정을 거치는 api를 제공한다. 이때 client ID가 사용된다. client
ID는 GCP에 연결해서 credentials에서 client key를 만들어야 한다. google
sign<sub>in</sub> package에 있는 demo가 있다. <a href="https://pub.dev/packages/google_sign_in">여기</a>에서 찾을 수 있다.
</p>
</div>
</div>

<div id="outline-container-org88b9bf9" class="outline-3">
<h3 id="org88b9bf9"><span class="section-number-3">3.2.</span> Demo실행</h3>
<div class="outline-text-3" id="text-3-2">
</div>
<div id="outline-container-org2ceec26" class="outline-4">
<h4 id="org2ceec26"><span class="section-number-4">3.2.1.</span> google<sub>sign</sub><sub>in</sub> package</h4>
<div class="outline-text-4" id="text-3-2-1">
<p>
여기에는 demo도 실행해 본다. demo를 실행할때 유의할께 있다. 첫번째,
project를 만들고, google<sub>sign</sub><sub>in</sub> package를 설치한다. 설치는 다음과
같다.
</p>
<div class="org-src-container">
<pre class="src src-shell">flutter pub add google_sign_in
</pre>
</div>
<p>
이것은 자동으로 pubspec.yaml에 google<sub>sign</sub><sub>in을</sub> 추가해주고 설치까지
해준다. 수동으로 할 수도 있다.
</p>

<div class="org-src-container">
<pre class="src src-shell">dependencies:
  google_sign_in: ^6.1.5
</pre>
</div>
<p>
pubspec.yaml에 직접 위와 같이 추가하고,
</p>

<div class="org-src-container">
<pre class="src src-shell">flutter pub get
</pre>
</div>
<p>
을 해주면 된다.
</p>

<p>
설치된 package는 다음과 같이 사용된다.
</p>

<div class="org-src-container">
<pre class="src src-dart"><span style="color: #948ae3;">import</span> <span style="color: #fce566;">'package:google_sign_in/google_sign_in.dart'</span>;
</pre>
</div>
</div>
</div>


<div id="outline-container-org6051526" class="outline-4">
<h4 id="org6051526"><span class="section-number-4">3.2.2.</span> http package</h4>
<div class="outline-text-4" id="text-3-2-2">
<p>
demo에 보면 http package가 있다. 이 package도 설치해 주어야
한다. 아래와 같이 실행해 준다.
</p>
<div class="org-src-container">
<pre class="src src-shell">flutter pub add http
</pre>
</div>
</div>
</div>

<div id="outline-container-org136e619" class="outline-4">
<h4 id="org136e619"><span class="section-number-4">3.2.3.</span> import 'src/sign<sub>in</sub><sub>button.dart</sub>'; 에러</h4>
<div class="outline-text-4" id="text-3-2-3">
<p>
이것은 main.dart가 속해있는 폴더의 src폴더아래에
sign<sub>in</sub><sub>button.dart라는</sub> 파일이 있어야 하는데 없다는 것이다. demo의
소스를 click하면 github이 나오는데, 거기서 해당 파일들을 복사해서 붙여
주면 된다.
</p>
</div>
</div>

<div id="outline-container-orge178279" class="outline-4">
<h4 id="orge178279"><span class="section-number-4">3.2.4.</span> 실행</h4>
<div class="outline-text-4" id="text-3-2-4">
<p>
ios simulator를 실행하고, flutter run으로 실행하면 다음과 같은 화면을
볼 수 있다.
</p>

<div id="org08ab0e6" class="figure">
<p><img src="../static/img/flutter/sign1.png" alt="sign1.png" width="400px" />
</p>
<p><span class="figure-number">Figure 20: </span>sign in</p>
</div>

<p>
버튼을 누르면 에러가 발생한다.
</p>

<div id="orgab8d57c" class="figure">
<p><img src="../static/img/flutter/clientID.png" alt="clientID.png" width="400px" />
</p>
<p><span class="figure-number">Figure 21: </span>clientID</p>
</div>

<p>
clientID가 없다는 에러가 난다. GCP에서 credentials을 만들면서
clientId를 다운받았었다. clientId는 info.plist로 다운받았었는데,
app에서 GCP로 접속시 인증 처리를 위해서 사용된다. 받은 client ID를
app에 포함시키는것을 integration이라고 한다. google<sub>sign</sub><sub>in</sub>
package에서 readme에 보면 ios integration방법이 나와 있다. android도
나와 있다. ios integration을 따라해보자. 그런데, 여기서는 xcode를
이용한다.
</p>
</div>
</div>

<div id="outline-container-org715a8d6" class="outline-4">
<h4 id="org715a8d6"><span class="section-number-4">3.2.5.</span> ios integration</h4>
<div class="outline-text-4" id="text-3-2-5">
<ol class="org-ol">
<li>다운받은 clientid(info.plist)를 GoogleService-Info.plist로 이름을 바꾼다.</li>
<li>project/ios/Runner 폴더에 복사한다.</li>
<li>Xcode를 연다.</li>
<li><p>
open project에서 project의 ios/Runner를 선택하면 ios Project가
만들어진다. Runner에 xcworkspace파일이 있어서 가능하다. 아니면 다음과 같이 해도 된다.
</p>
<div class="org-src-container">
<pre class="src src-shell">open ios/Runner.xcworkspace
</pre>
</div></li>
<li><p>
xcode가 띄어진 상태에서, project의 Runner디렉토리에 오른쪽 버튼을
눌러서 Add Files To Runner를 선택한다. 그리고
GoogleService-info.plist를 선택한다.
</p>

<div id="orge83646f" class="figure">
<p><img src="../static/img/flutter/clientID2.png" alt="clientID2.png" width="400px" />
</p>
<p><span class="figure-number">Figure 22: </span>clientid등록</p>
</div></li>
<li></li>

<li></li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2023-10-17 Tue 00:00</p>
<p class="author">Author: hoyoul</p>
<p class="date">Created: 2023-11-26 Sun 03:37</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>